<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Login - Select Group</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
    <link rel="icon" type="image/svg+xml" href="/assets/favicon.svg">
    <style>
        .gradient-bg { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-8px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-50 to-blue-50 min-h-screen flex items-center justify-center p-4">
    <div class="max-w-md w-full">
        <!-- Logo/Header -->
        <div class="text-center mb-8">
            <div class="gradient-bg text-white rounded-full w-16 h-16 flex items-center justify-center mx-auto mb-4">
                <i class='bx bx-shield text-3xl'></i>
            </div>
            <h1 class="text-3xl font-bold text-gray-800">Admin Access</h1>
            <p class="text-gray-600 mt-2">Select your group to login</p>
        </div>

        <!-- Group Selection -->
        <div class="grid grid-cols-1 gap-4 mb-6">
            <!-- Group 1 -->
            <div onclick="selectGroup(1)" class="card-hover bg-white rounded-lg shadow p-6 cursor-pointer border-2 border-transparent hover:border-purple-600">
                <div class="flex items-center">
                    <div class="gradient-bg text-white rounded-lg p-4 mr-4">
                        <i class='bx bx-group text-2xl'></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-800">Group 1</h3>
                        <p class="text-sm text-gray-600">Access Group 1 Dashboard</p>
                    </div>
                    <label for="group1" class="sr-only">Select Group 1</label>
                    <input type="radio" name="group" value="1" id="group1" class="w-4 h-4">
                </div>
            </div>

            <!-- Group 2 -->
            <div onclick="selectGroup(2)" class="card-hover bg-white rounded-lg shadow p-6 cursor-pointer border-2 border-transparent hover:border-blue-600">
                <div class="flex items-center">
                    <div class="bg-gradient-to-br from-blue-600 to-blue-800 text-white rounded-lg p-4 mr-4">
                        <i class='bx bx-group text-2xl'></i>
                    </div>
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-800">Group 2</h3>
                        <p class="text-sm text-gray-600">Access Group 2 Dashboard</p>
                    </div>
                    <label for="group2" class="sr-only">Select Group 2</label>
                    <input type="radio" name="group" value="2" id="group2" class="w-4 h-4">
                </div>
            </div>
        </div>

        <!-- Login Form -->
        <form id="loginForm" class="bg-white rounded-lg shadow-lg p-6 space-y-4">
            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Username</label>
                <input 
                    type="text" 
                    name="username" 
                    id="username"
                    placeholder="Enter your username"
                    class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                    required
                >
            </div>

            <div>
                <label class="block text-sm font-semibold text-gray-700 mb-2">Password</label>
                <input 
                    type="password" 
                    name="password" 
                    id="password"
                    placeholder="Enter your password"
                    class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-600 focus:outline-none"
                    required
                >
            </div>

            <button 
                type="submit"
                class="w-full gradient-bg text-white font-bold py-2 px-4 rounded-lg hover:opacity-90 transition flex items-center justify-center"
            >
                <i class='bx bx-log-in mr-2'></i>
                Login
            </button>
        </form>

        <!-- Guest Login -->
        <div class="mt-4 text-center">
            <p class="text-gray-600 text-sm">Test without credentials?</p>
            <button onclick="testLogin()" class="text-purple-600 hover:text-purple-800 font-semibold text-sm">
                Try Test Account
            </button>
        </div>
    </div>

    <script>
        let selectedGroup = 1;

        function selectGroup(group) {
            selectedGroup = group;
            document.getElementById(`group${group}`).checked = true;
            
            // Visual feedback
            document.querySelectorAll('[name="group"]').forEach((radio, idx) => {
                const card = radio.closest('div').parentElement;
                if (radio.checked) {
                    card.classList.add('ring-2', 'ring-purple-600');
                } else {
                    card.classList.remove('ring-2', 'ring-purple-600');
                }
            });
        }

        document.getElementById('loginForm').onsubmit = async (e) => {
            e.preventDefault();
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            if (!username || !password) {
                Swal.fire('Error', 'Please fill in all fields', 'error');
                return;
            }

            try {
                const response = await fetch('api/admin_login.php', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        username: username,
                        password: password,
                        group: selectedGroup
                    })
                });

                const data = await response.json();

                if (data.ok || data.success) {
                    Swal.fire({
                        icon: 'success',
                        title: 'Login Successful',
                        text: `Welcome to Group ${selectedGroup}`,
                        timer: 1500,
                        showConfirmButton: false
                    }).then(() => {
                        window.location.href = 'admin-enhanced.php';
                    });
                } else {
                    Swal.fire('Error', data.error || 'Login failed', 'error');
                }
            } catch (error) {
                Swal.fire('Error', 'Connection failed: ' + error.message, 'error');
            }
        };

        function testLogin() {
            document.getElementById('username').value = 'admin';
            document.getElementById('password').value = 'admin';
            selectGroup(1);
            document.getElementById('loginForm').dispatchEvent(new Event('submit'));
        }

        // Select Group 1 by default
        selectGroup(1);
    </script>
</body>
</html>
